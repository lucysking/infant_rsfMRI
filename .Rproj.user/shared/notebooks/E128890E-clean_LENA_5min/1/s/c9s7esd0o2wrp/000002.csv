"0","lena_time_cl <-"
"0","  lena_time_cl %>% "
"0","  arrange(ID, time_hours) %>% "
"0","  group_by(ID, day) %>% "
"0","  mutate("
"0","    # first ct"
"0","    ct_first_row = head(which(CTC.Actual != 0), 1),"
"0","    ct_first = nth(CTC.Actual, n = ct_first_row[1]),"
"0","    ct_first_time = nth(time_hours, n = ct_first_row[1]),"
"0","    # last ct"
"0","    ct_last_row = tail(which(CTC.Actual != 0), 1),"
"0","    ct_last = nth(CTC.Actual, n = ct_last_row[1]),"
"0","    ct_last_time = nth(time_hours, n = ct_last_row[1]),"
"0","    # create grouping variable for time of day "
"0","    time_day = case_when("
"0","      time_hours >= ct_first_time & time_hours <= 10 ~ ""AM"","
"0","      time_hours >= 10 & time_hours < 13 ~ ""MID"","
"0","      time_hours >= 13 & time_hours < 17 ~ ""AFT"","
"0","      time_hours >= 17 & time_hours < ct_last_time ~ ""PM"""
"0","    )"
"0","  ) %>% "
"0","  select(-ct_last_row, -ct_first_row) %>% "
"0","  # remove observations froms times of day before first CT or after last CT"
"0","  filter(!is.na(time_day))"
