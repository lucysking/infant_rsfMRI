"0","factor_names = c("
"0","  ""Factor 1:\nSymptoms"", "
"0","  ""Factor 2:\nCompetence"""
"0","  )"
"0","loadings <-"
"0","  itsea_fa2$loadings[] %>% "
"0","  data.frame() %>% "
"0","  rownames_to_column(""measure"") %>% "
"0","  gather(factor, loading, -measure) %>%  "
"0","  mutate(factor = as.character(factor(factor, labels = factor_names))) "
"0","  "
"0","# get fa.sort() order"
"0","order <- "
"0","  loadings %>%"
"0","  group_by(measure) %>%"
"0","  top_n(1, abs(loading)) %>%"
"0","  ungroup() %>%"
"0","  arrange(desc(factor), abs(loading)) %>%"
"0","  mutate(order = 1:length(levels(factor(loadings$measure)))) %>%"
"0","  select(measure, order)"
"0","  "
"0","# get percent shared variance explained"
"0","shared_var <- itsea_fa2$Vaccounted %>%"
"0","  data.frame() %>%"
"0","  rownames_to_column(""stat"") %>%"
"0","  filter(stat == ""Proportion Var"") %>%"
"0","  select(-stat) %>%"
"0","  gather(factor, var) %>%"
"0","  mutate(factor = as.character(factor(factor, labels = factor_names))) %>%"
"0","  mutate(var = paste0(factor, ""\n("", round(var, 2)*100, ""% var.)""))"
"0","  # make plot"
"0","loadings_plot_data <- "
"0","  loadings %>% "
"0","  left_join(order, by = ""measure"") %>%"
"0","  left_join(shared_var, by = ""factor"")"
"0","loadings_plot_data %>% "
"0","  mutate("
"0","    measure = fct_recode("
"0","      measure,"
"0","      Activity = ""itsea_activity"", "
"0","      Aggression = ""itsea_agress"", "
"0","      Depression = ""itsea_depp"", "
"0","      Anxiety = ""itsea_gad"", "
"0","      Play = ""itsea_play"","
"0","      Empathy = ""itsea_empath"","
"0","      `Negative emotionality` = ""itsea_negemo"","
"0","      `Pro-social relations` = ""itsea_social"""
"0","    )"
"0","  ) %>% "
"0","  ggplot("
"0","    aes("
"0","      x = var, "
"0","      y = reorder(measure, order), "
"0","      fill = loading,"
"0","      label = round(loading, 2)"
"0","    )"
"0","  ) +"
"0","  geom_tile(color = ""black"") +"
"0","  geom_text(size = 6, color = ""black"") +"
"0","  scale_fill_distiller("
"0","    limits = c(-1, 1), "
"0","    palette = ""RdYlBu"","
"0","    guide = guide_colorbar(barheight = 20)"
"0","  ) +"
"0","  scale_x_discrete(position = ""top"") +"
"0","  theme_minimal() +"
"0","  theme("
"0","    legend.title = element_text(size = 16),"
"0","    legend.text = element_text(size = 14),"
"0","    axis.title = element_blank(), "
"0","    axis.text.y = element_text(size = 18),"
"0","    axis.text.x = element_text(size = 17)"
"0","  )"
